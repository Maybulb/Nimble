<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Nimble</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="../node_modules/font-awesome/css/font-awesome.min.css">

		<!-- loaders.css -->
		<link rel="stylesheet" href="../node_modules/loaders.css/loaders.min.css">
		<script src="js/script.js"></script>

	</head>
	<body>
		<div class="input">
			<input type="text" id="input" autofocus>
			<button type="button" onclick="query()">&#61442;</button>
		</div>
		<div class="interpret">
			<em>Interpreted as:</em> <span id="queryInterpretation">query interpretation</span>
		</div>
		<div class="output"> <!-- temporary -->
		</div>

		<!-- scripts -->
		<script src="../node_modules/loaders.css/loaders.css.js"></script>

		<script>
		try {
			window.options = require("../options.json") || {
				"mathjs": true,
				"speech": false
			};
		} catch (e) {
			window.options = {
				"mathjs": true,
				"speech": false
			};

			ipcRenderer.send("save_options", JSON.stringify(window.options));
		}

		const remote = require('electron').remote;
		const Menu = remote.Menu;
		const MenuItem = remote.MenuItem;

		var menuItems = [
			{
				label: "Copy",
				submenu: [
					{
						label: 'Plain Text',
						accelerator: "CmdOrCtrl+Shift+C",
						click: function() {
							clipboardCopy.text()
						}
					},
					{
						label: 'Wolfram|Alpha Link',
						accelerator: "CmdOrCtrl+Shift+L",
						click: function() {
							clipboardCopy.link()
						}
					},
					{
						label: "Image (in progress...)",
						enabled: false,
						accelerator: "CmdOrCtrl+Shift+I",
						click: function() {
							clipboardCopy.image()
						}
					}
				]
			},
			{
				label: "Share",
				submenu: [
					{
						label: "Twitter",
						accelerator: "CmdOrCtrl+Shift+T",
						click: function() {
							shareButton.twitter()
						}
					}
				]
			},
			{
				type: "separator"
			},
			{
				label: "Quit",
				accelerator: "CmdOrCtrl+W",
				role: "close",
				click: function() {
					app.quit()
				}
			},
			{
				label: "Preferences",
				submenu: [
					{
						label: "Do simpler math offline with Math.js?",
						sublabel: "This saves a lot of time, but may not always give you the right answer.",
						type: "checkbox",
						checked: window.options.mathjs,
						click: function() {
							preferences.save();
						}
					},
					{
						label: "Speech (alpha)",
						type: "checkbox",
						checked: window.options.speech,
						click: function() {
							preferences.save();
						}
					}
				]
			}
		]

		var menuthing = new Menu.buildFromTemplate(window.menuItems);

		var output = document.getElementsByClassName("output")[0];
		output.addEventListener('contextmenu', function (e) {
		  e.preventDefault();
		  menuthing.popup(remote.getCurrentWindow());
		}, false);
		</script>
	</body>
</html>
